{
    "contents" : "---\ntitle: \"Analyzing Risk with ICD-10 Data\"\nauthor: \"Sidharth Jain\"\ndate: \"May 25, 2016\"\noutput: html_document\n---\n\nTo determine the liability of patients in Medicare, CMS uses the HCC (Hierarchical Condition Categories) to determine risk scores.  This scoring was extended upon implementation of the Affordable Care Act, to create the HHS-HCC Risk Adjustment Model.  Here, I attempt to simulate the risk scoring algorithm using simulated claims data, in hopes to be able to extend this algorithm for larger data sets of real claims data from patients.  \n\nRisk adjustment calculations are significant in terms of cost analysis and reduction for health insurance companies and accountable care organizations.  High risk individuals tend to be the most expensive.  Identifying these individuals and providing preventive care may significantly reduce the cost of providing healthcare, as well as reducing risk transfer (more on that to follow).\n\n\n### Data and Descriptions\n\nTo begin, I first load in the necessary data.  I am using the most current ICD-10 to HCC key available from CMS.  \n\n```{r}\nhcc2icd10 <- read.csv(\"~/Documents/Valera/RiskAnalysis/HHS_HCC_TO_ICD10.csv\")\nhead(hcc2icd10)\n```\n\nThe data contains the following information: \n\n- ICD-10 Diagnosis Code\n- Description of Code\n- Age limitations for Code\n- HCC Code\n- Other specific data about code use\n\nWe will be generating simulated patient data using ICD-10 codes of patients with 2 or more (up to 5)  comorbidities, and assessing risk for these patients.\n\nFor now, I'm only dealing with adults between the ages of 21-64 out of convenience and rapid prototyping, but this algorithm can be expanded to cover infants (0-1), children (2-20), and seniors (65+).\n\n```{r}\n### Generating sample data:\npatient.ids <- sample(1:10000, size=1000, replace=F)\n\npatient.ages <- sample(21:80, size=1000, replace=T)\n\npatient.sexes <- as.factor(sample(1:2, size=1000, replace=T)) # 1 if male, 2 if female\n\nicd10s <- unique(hcc2icd10$ICD10)\n\n# everyone has 1 comorbidity\nmorbidity1 <- sample(icd10s, size=1000, replace=T)  \n# everyone has 2nd comorbidity\nmorbidity2 <- sample(icd10s, size=1000, replace=T) \n\n# 75% have 3rd comorbidity\nmorbidity3 <- sapply(sample(icd10s, size=1000, replace=T), function(x){\n    sample(c(x, NA), size=1, prob=c(0.75, 0.25))\n})\n\n# 25% have 4th comorbidity\nmorbidity4 <- sapply(sample(icd10s, size=1000, replace=T), function(x){\n    sample(c(x, NA), size=1, prob=c(0.25, 0.75))\n})\n\n# 5% have 5th comorbidity\nmorbidity5 <- sapply(sample(icd10s, size=1000, replace=T), function(x){\n    sample(c(x, NA), size=1, prob=c(0.05, 0.95))\n})\n\n# Simulated Data:\nPatientData <- data.frame(patient.ids, patient.sexes, patient.ages, morbidity1, morbidity2, morbidity3, morbidity4, morbidity5)\n\n(head(PatientData))\n```\n\nNow that the data has been simulated, I can use known HCC Risk Calculations to determine risk on each of these patients.  In order to do so, each value must be mapped with the corresponding liability value to determine whether or not the risk assessment of the patient is higher or lower than the normal.\n\nTo calculate age/sex liability, we use the following function with conditionals.\n\n### Age/Sex Risk Analysis\n(Assuming Platinum Plan liability with HCC-HMS population extrapolation)\n```{r}\nM <- c(rep(0.258, 4), sapply(c(0.278, 0.338, 0.413, 0.487, 0.581, 0.737, 0.863, 1.028), rep, 5))\n\nF <- c(rep(0.433, 4), sapply(c(0.548, 0.656, 0.76, 0.839, 0.878, 1.013, 1.054, 1.156), rep, 5))\n\nAgeANDSex2Risk.table <-\n    data.frame(M, F, row.names = 21:64)\n\nAgeANDSex2Risk <- function(age, sex){\n    \n    maleLiabEsts.21_65 <- c(rep(0.258, 4), sapply(c(0.278, 0.338, 0.413, 0.487, 0.581, 0.737, 0.863, 1.028), rep, 5))\n    if(sex==1){\n        if(age %in% 21:24)\n            return(0.258)\n        else if(age %in% 25:29)\n            return(0.278)\n        else if(age %in% 30:34)\n            return(0.413)\n        else if(age %in% 35:39)\n            return(0.487)\n        else if\n    } # if male\n}}\n```\n\n\n\n\n\n",
    "created" : 1464194523809.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4224423933",
    "id" : "6BEDD477",
    "lastKnownWriteTime" : 1464712193,
    "path" : "~/Documents/Valera/RiskAnalysis/RiskAnalysis.Rmd",
    "project_path" : "RiskAnalysis.Rmd",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_markdown"
}